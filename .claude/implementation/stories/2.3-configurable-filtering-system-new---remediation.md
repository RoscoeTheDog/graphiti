# Story 2.3: Configurable Filtering System (NEW - REMEDIATION)
**Status**: unassigned
**Parent**: Story 2
**Created**: 2025-11-17 00:05

**Parent**: Story 2
**Depends on**: Story 2
**Description**: Add configurable filtering rules for opt-in/opt-out per message type with multiple content modes (full/omit/summary)
**Rationale**: Existing filter.py has fixed rules. User requires flexible configuration to control what gets tracked and how content is processed (full preservation, omission, or LLM summarization).
**File**: `graphiti_core/session_tracking/filter_config.py` (new), `filter.py` (modify)
**Acceptance Criteria**:
- [ ] FilterConfig dataclass created with per-type settings:
  - [ ] `tool_calls: bool` - Track tool call structure (default: true)
  - [ ] `tool_content: ContentMode` - Tool result content mode (default: "summary")
  - [ ] `user_messages: ContentMode` - User message content mode (default: "full")
  - [ ] `agent_messages: ContentMode` - Agent message content mode (default: "full")
  - [ ] ContentMode enum: "full" | "omit" | "summary"
- [ ] Configuration integrated into SessionTrackingConfig in unified_config.py
- [ ] SessionFilter.filter_messages() updated to use configuration
- [ ] Summarizer class integration for ContentMode.SUMMARY (reuse existing summarizer.py or create lightweight version)
- [ ] Unit tests for all configuration combinations (9+ test scenarios)
- [ ] Documentation: CONFIGURATION.md updated with filtering options
- [ ] **Cross-cutting requirements satisfied** (see CROSS_CUTTING_REQUIREMENTS.md):
  - [ ] Type hints and Pydantic models for configuration
  - [ ] Error handling with logging (invalid config)
  - [ ] >80% test coverage
  - [ ] Configuration uses unified system
  - [ ] Documentation updated

**Implementation Notes**:
- Reuse existing summarizer.py if present, or create minimal LLM summarization for ContentMode.SUMMARY
- Default configuration maintains current behavior (user/agent full, tool content summarized)
- Backward compatible design

