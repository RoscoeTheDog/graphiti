# Plan: 1
# Generated by: discovery:1.d
# Timestamp: 2025-12-13T02:16:00Z

story_id: "1"
title: "Remove Deprecated Config Parameters"
created: "2025-12-13T02:16:00Z"
created_by: "discovery:1.d"

# Analysis Summary
analysis:
  summary: "Remove 3 deprecated parameters (inactivity_timeout, check_interval, auto_summarize) from config schema, validation, unified config, and global config file. Clean removal with no functional impact since turn-based architecture replaced time-based session detection."
  complexity: "low"
  estimated_files: 4
  estimated_tokens: 3500
  risk_factors:
    - "Backward compatibility - users with old configs will need manual updates"
    - "Must update both code schema and JSON schema file"
    - "Global config file requires manual edit (user data)"

# Files to Create
files_to_create: []

# Files to Modify
files_to_modify:
  - path: "mcp_server/unified_config.py"
    changes:
      - "Remove inactivity_timeout field from SessionTrackingConfig (lines 619-626)"
      - "Remove check_interval field from SessionTrackingConfig (lines 627-633)"
      - "Remove auto_summarize field from SessionTrackingConfig (lines 634-640)"
    lines_affected: 22

  - path: "mcp_server/config_validator.py"
    changes:
      - "Remove inactivity_timeout validation (lines 244-249)"
      - "Remove check_interval validation (lines 251-256)"
    lines_affected: 12

  - path: "graphiti.config.schema.json"
    changes:
      - "Remove inactivity_timeout property from session_tracking schema (lines 934-939)"
      - "Remove check_interval property from session_tracking schema (lines 940-945)"
      - "Remove auto_summarize property from session_tracking schema (lines 946-951)"
    lines_affected: 18

  - path: "mcp_server/graphiti_mcp_server.py"
    changes:
      - "Remove inactivity_timeout from session_tracking_status docstring (line 2042)"
      - "Remove check_interval from session_tracking_status docstring (line 2043)"
      - "Remove inactivity_timeout from global_config dict (line 2079)"
      - "Remove check_interval from global_config dict (line 2080)"
      - "Remove _inactivity_timeout_help from config generation (line 2528)"
      - "Remove _check_interval_help from config generation (line 2530)"
      - "Remove _auto_summarize_help from config generation (line 2532)"
    lines_affected: 7

  - path: "~/.graphiti/graphiti.config.json"
    changes:
      - "Remove inactivity_timeout field (line 34)"
      - "Remove _inactivity_timeout_help comment (line 35)"
      - "Remove check_interval field (line 36)"
      - "Remove _check_interval_help comment (line 37)"
      - "Remove auto_summarize field (line 38)"
      - "Remove _auto_summarize_help comment (line 39)"
    lines_affected: 6
    note: "Manual edit required - this is user data outside repository"

# Integration Points
integration:
  - file: "mcp_server/unified_config.py"
    type: "config"
    description: "SessionTrackingConfig class defines config schema - removal propagates to all config loading"

  - file: "graphiti.config.schema.json"
    type: "config"
    description: "JSON schema validation - must stay in sync with Pydantic model"

  - file: "mcp_server/config_validator.py"
    type: "config"
    description: "Runtime validation - remove checks for deprecated fields to prevent false errors"

# Patterns to Follow
patterns:
  - source: "mcp_server/unified_config.py"
    pattern: "Pydantic Field() definitions with description and default - simply delete entire field blocks"

  - source: "graphiti.config.schema.json"
    pattern: "JSON schema property definitions - delete property objects including title, description, type, default"

  - source: "mcp_server/config_validator.py"
    pattern: "Validation if-blocks with add_error() calls - delete entire conditional blocks"

# Test Requirements
test_requirements:
  unit:
    - "Test SessionTrackingConfig instantiation without deprecated fields"
    - "Test config validator does not check for deprecated fields"
    - "Test schema validation accepts configs without deprecated fields"
    - "Test session_tracking_status does not return deprecated fields"

  integration:
    - "Test loading graphiti.config.json without deprecated fields"
    - "Test MCP server starts with updated config schema"
    - "Test config generation produces files without deprecated help text"

  security:
    - "Verify no sensitive data exposed through deprecated field removal"

# Acceptance Criteria Mapping
acceptance_criteria:
  - id: "AC-1.1"
    text: "(P0) Remove 3 deprecated fields from SessionTrackingConfig in unified_config.py"
    implementation: "files_to_modify[0]"
    tests: "test_requirements.unit[0]"

  - id: "AC-1.2"
    text: "(P0) Remove validation logic for these fields in config_validator.py"
    implementation: "files_to_modify[1]"
    tests: "test_requirements.unit[1]"

  - id: "AC-1.3"
    text: "(P0) Remove deprecated params from ~/.graphiti/graphiti.config.json (global config)"
    implementation: "files_to_modify[4]"
    tests: "test_requirements.integration[0]"
    note: "Manual step - cannot be automated (user data)"

  - id: "AC-1.4"
    text: "(P1) Update graphiti.config.schema.json to remove deprecated fields"
    implementation: "files_to_modify[2]"
    tests: "test_requirements.unit[2]"

  - id: "AC-1.5"
    text: "(P1) Remove help text comments from config generation in graphiti_mcp_server.py"
    implementation: "files_to_modify[3]"
    tests: "test_requirements.integration[2]"
