# Implementation Sprint: Turn-Based Preprocessing Injection

**Version**: 1.0
**Created**: 2025-12-12 00:39
**Base Branch**: dev
**Status**: Active

## Sprint Goal

Implement preprocessing prompt injection into Graphiti's extraction pipeline using the existing `custom_prompt` field. This enables single-pass LLM processing for turn-based indexing, providing ~13% token savings by eliminating redundant summarization passes. The implementation follows the bool|str configuration pattern from FilterConfig and supports template hierarchy resolution.

## Stories

### Story 1: Create ExtractionConfig Schema
**Status**: unassigned
**See**: [stories/1-create-extractionconfig-schema.md](stories/1-create-extractionconfig-schema.md)

### Story 2: Extend GraphitiClients with Preprocessing Fields
**Status**: unassigned
**See**: [stories/2-extend-graphiticlients-preprocessing.md](stories/2-extend-graphiticlients-preprocessing.md)

### Story 3: Create Default Session Turn Template
**Status**: unassigned
**See**: [stories/3-create-default-session-turn-template.md](stories/3-create-default-session-turn-template.md)

### Story 4: Modify node_operations.py for Preprocessing Injection
**Status**: unassigned
**See**: [stories/4-modify-node-operations-preprocessing.md](stories/4-modify-node-operations-preprocessing.md)

### Story 5: Modify edge_operations.py for Preprocessing Injection
**Status**: unassigned
**See**: [stories/5-modify-edge-operations-preprocessing.md](stories/5-modify-edge-operations-preprocessing.md)

### Story 6: Add Extraction Config to unified_config.py
**Status**: unassigned
**See**: [stories/6-add-extraction-config-unified.md](stories/6-add-extraction-config-unified.md)

### Story 7: Wire Preprocessing in MCP Server Initialization
**Status**: unassigned
**See**: [stories/7-wire-preprocessing-mcp-server.md](stories/7-wire-preprocessing-mcp-server.md)

### Story 8: Implement TemplateResolver with Hierarchy
**Status**: unassigned
**See**: [stories/8-implement-templateresolver.md](stories/8-implement-templateresolver.md)

### Story 9: Add Template Validation and Error Handling
**Status**: unassigned
**See**: [stories/9-template-validation-error-handling.md](stories/9-template-validation-error-handling.md)

### Story 10: Unit Tests for Preprocessing Injection
**Status**: unassigned
**See**: [stories/10-unit-tests-preprocessing.md](stories/10-unit-tests-preprocessing.md)

### Story 11: Update CONFIGURATION.md with Extraction Section
**Status**: unassigned
**See**: [stories/11-update-configuration-docs.md](stories/11-update-configuration-docs.md)

---

*Generated by /sprint:CREATE_SPRINT v3.1.0*
