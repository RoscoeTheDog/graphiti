---
description: Resilience Integration for Manual Sync
---

# Feature 13.3: Resilience Integration for Manual Sync

**Type**: Feature (Container)
**Status**: unassigned
**Parent**: 13
**Created**: 2025-12-04T00:30:38.901877

---

## Phase Status

| Phase | Story ID | Status | Artifact |
|-------|----------|--------|----------|
| Discovery | 13.3.d | pending | plans/13.3-plan.yaml |
| Implementation | 13.3.i | pending | Code changes |
| Testing | 13.3.t | pending | test-results/13.3-results.json |

---

## Description

Integrate the manual sync functionality with Story 19's resilience layer. This ensures that manual sync operations use the circuit breaker for LLM availability, queue failed sessions to retry_queue for later retry, and support progress tracking for resumability.

---

## Acceptance Criteria

- [ ] Use `resilient_indexer.py` instead of direct `SessionIndexer` in `index_session_sync()`
- [ ] Failed sessions are added to `retry_queue` for later retry
- [ ] Respect circuit breaker state (skip indexing if LLM unavailable)
- [ ] Return degradation status in response (full/partial/raw_only)
- [ ] Add progress tracking (sessions processed / total)
- [ ] Support resuming interrupted syncs
- [ ] Add integration test with mocked LLM failure

---

## Implementation Notes

### Approach

Update `manual_sync.py` to accept optional `resilient_indexer` and `retry_queue` parameters. When provided, use them instead of direct `SessionIndexer`.

### Files to Modify

- `mcp_server/manual_sync.py` - Add resilience integration
- `mcp_server/graphiti_mcp_server.py` - Pass resilient_indexer to sync function
- `tests/session_tracking/test_manual_sync_resilience.py` - Add tests

### Testing Requirements

- Test sync uses resilient indexer when available
- Test failed sessions are queued for retry
- Test progress callback is invoked

---

## 5W Completeness Check

- **Who**: Users running bulk historical syncs
- **What**: Resilience integration for manual sync
- **When**: When manual sync encounters LLM rate limits or failures
- **Where**: `mcp_server/manual_sync.py`
- **Why**: Bulk syncs are expensive; failures should be queued not lost

---

## Metadata

**Workload Score**: TBD
**Estimated Tokens**: TBD
**Dependencies**: None
**Phase Children**: 13.3.d, 13.3.i, 13.3.t
