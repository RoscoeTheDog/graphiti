# Story 15.1: Documentation Remediation - USER_GUIDE and MIGRATION Fixes

**Status**: unassigned
**Created**: 2025-11-19 20:45
**Parent**: Story 15
**Priority**: MEDIUM
**Estimated Effort**: 4 hours
**Phase**: 7.1 (Week 3, Day 5)
**Depends on**: Story 15 (advisory_medium - critical fixes done)

## Description

Complete the remaining documentation work from Story 15. Fix inaccuracies in SESSION_TRACKING_USER_GUIDE.md and SESSION_TRACKING_MIGRATION.md, validate all examples, and ensure documentation matches actual implementation.

**Scope**:
- Update SESSION_TRACKING_USER_GUIDE.md with correct field names and missing sections
- Fix SESSION_TRACKING_MIGRATION.md template references and syntax
- Validate all examples against actual system
- Test quick start guide on fresh install

## Acceptance Criteria

### SESSION_TRACKING_USER_GUIDE.md Fixes (7 ACs)
- [ ] Fix field name: `watch_directories` → `watch_path`
- [ ] Fix field name: `inactivity_timeout_minutes` → `inactivity_timeout` (seconds)
- [ ] Fix field name: `scan_interval_seconds` → `check_interval`
- [ ] Fix CLI command format: `graphiti-mcp session-tracking` → `graphiti-mcp-session-tracking`
- [ ] Add manual sync documentation section
- [ ] Add troubleshooting section
- [ ] Add security best practices section

### SESSION_TRACKING_MIGRATION.md Fixes (4 ACs)
- [ ] Fix template references: `.j2` (Jinja2) → `.md` (Markdown)
- [ ] Fix field name: `filter_config` → `filter`
- [ ] Fix template syntax: Jinja2 → `{content}` placeholder
- [ ] Update CLI command format throughout

### Example Validation (2 ACs)
- [ ] Test quick start guide on fresh install
- [ ] Validate all migration examples work correctly

## Implementation Details

### USER_GUIDE.md Changes

**Section: Configuration**

Replace:
```json
{
  "session_tracking": {
    "enabled": false,
    "watch_directories": [
      "~/.claude/projects"
    ],
    "inactivity_timeout_minutes": 30,
    "scan_interval_seconds": 2
  }
}
```

With:
```json
{
  "session_tracking": {
    "enabled": false,
    "watch_path": "~/.claude/projects",
    "inactivity_timeout": 900,
    "check_interval": 60,
    "auto_summarize": false,
    "keep_length_days": 7
  }
}
```

**Add Manual Sync Section**:
```markdown
## Manual Sync Command

Manually sync historical sessions beyond the rolling window:

```bash
# Sync last 30 days
graphiti-mcp-session-tracking sync --days 30 --dry-run

# Actually sync (after reviewing dry-run)
graphiti-mcp-session-tracking sync --days 30 --no-dry-run

# Sync all unindexed sessions (use with caution - may be expensive)
graphiti-mcp-session-tracking sync --days 0
```

**Use Cases**:
- Migrate sessions from before session tracking was enabled
- Re-index after configuration changes
- Recover from indexing failures

**Cost Warning**: Syncing large backlogs can incur significant LLM costs. Always use `--dry-run` first.
\```
```

**Add Troubleshooting Section**:
```markdown
## Troubleshooting

### Session Not Indexing

**Symptom**: Sessions not appearing in knowledge graph after inactivity timeout

**Check**:
1. Verify session tracking enabled: `graphiti-mcp-session-tracking status`
2. Check MCP server logs for errors
3. Verify Neo4j connection working
4. Check file permissions on JSONL files

**Fix**:
```bash
# Enable if disabled
graphiti-mcp-session-tracking enable

# Manually sync session
graphiti-mcp-session-tracking sync --days 1
\```

### High LLM Costs

**Symptom**: Unexpected OpenAI charges

**Check**:
```bash
# Check current config
graphiti-mcp-session-tracking status
\```

**Fix**:
```json
{
  "session_tracking": {
    "auto_summarize": false,  // Disable LLM costs
    "keep_length_days": 7     // Limit to recent sessions
  }
}
\```
```

**Add Security Best Practices**:
```markdown
## Security Best Practices

1. **Opt-In Model**: Session tracking is disabled by default. Only enable if you need cross-session memory.

2. **Sensitive Data**: Avoid including passwords, API keys, or PII in Claude Code sessions. Use environment variables instead.

3. **Rolling Window**: Set `keep_length_days` to limit historical data retention (recommended: 7-30 days).

4. **Filtering**: Use aggressive filtering to minimize stored content:
   ```json
   {
     "filter": {
       "tool_content": false,      // Omit tool outputs
       "user_messages": false,      // Omit user messages
       "agent_messages": "default-agent-messages.md"  // Summarize only
     }
   }
   ```

5. **Access Control**: Secure your Neo4j database with strong credentials and network restrictions.

6. **Data Deletion**: Use `graphiti-mcp episodes cleanup` to remove old sessions.
```

### MIGRATION.md Changes

**Find and Replace**:
1. `.j2` → `.md` (all template file extensions)
2. `filter_config` → `filter` (all occurrences)
3. `{{ tool_name }}` → `Tool: {tool_name}` (template syntax)
4. `{{ content }}` → `{content}` (template placeholders)
5. `graphiti-mcp session-tracking` → `graphiti-mcp-session-tracking` (CLI commands)

**Example Fix**:

Before:
```json
{
  "filter_config": {
    "tool_calls": "templates/tool_summary.j2"
  }
}
```

After:
```json
{
  "filter": {
    "tool_calls": "default-tool-content.md"
  }
}
```

Before:
```bash
cat > templates/tool_summary.j2 << 'EOF'
Tool: {{ tool_name }}
{% if result.success %}✅{% else %}❌{% endif %}
EOF
```

After:
```bash
cat > ~/.graphiti/auto-tracking/templates/custom-tool.md << 'EOF'
Summarize this tool result in 1 sentence.

Tool: {tool_name}
Result: {content}
EOF
```

## Testing Requirements

1. **Fresh Install Test**:
   - Create clean test environment
   - Follow quick start guide exactly
   - Verify each step works
   - Document any issues found

2. **Migration Example Test**:
   - Start with v1.0.0 config format
   - Apply migration examples
   - Verify system works correctly
   - Test all 3 migration paths (Minimal, Enhanced, Privacy-First)

3. **Configuration Validation**:
   - Test each JSON example in documentation
   - Verify all field names are correct
   - Ensure all examples load without errors

## Dependencies

- Story 15 (advisory_medium - critical CONFIGURATION.md fixes done) - REQUIRED

## Related Documents

- Story 15 (parent story)
- `docs/SESSION_TRACKING_USER_GUIDE.md`
- `docs/SESSION_TRACKING_MIGRATION.md`
- `CONFIGURATION.md`

## Cross-Cutting Requirements

See parent sprint `.claude/implementation/CROSS_CUTTING_REQUIREMENTS.md`:
- Documentation: Complete and accurate user docs
- Examples: All examples tested and working
- Migration guide: Accurate upgrade path
